  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mudravani - Model</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='model.css') }}" />
  <!-- Remixicons CDN -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet" />
</head>
<body>
  <header>
    <h2 id="main-logo">Mudravani</h2>
    <a href="#live-model" id="model-nav-tag">Testing Model</a>
    <div class="socials">
      <ul>
        <li><a href="" target="_blank"><i class="ri-github-fill"></i></a></li>
        <li><a href="#"><i class="ri-twitter-x-fill"></i></a></li>
        <div id="vertical-line"></div>
        <li><a id="dark-theme"><i class="ri-sun-line"></i></a></li>
        <li><a href="#"><i class="ri-translate-2"></i></a></li>
        <li><a href="#">Log in</a></li>
      </ul>
    </div>
  </header>

    <main>
      <span>Welcome to Mudravani's sign detection model. The work here is under developmental stage.</span>

      <div class="live-model" id="live-model">
        <h2>Mudravani - Test Phase Model</h2>
        <img
          id="cam-feed"
          src="{{ url_for('video_feed') }}"
          width="640"
          height="480"
          alt="Webcam stream will appear here"
          style="border: 2px solid #ccc;"
          onerror="this.onerror=null; this.src='https://via.placeholder.com/640x480?text=Stream+not+available';"
        />

        <div class="detection-panel" style="background-color: #f5f5f5; padding: 20px; border-radius: 10px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
          <h3 style="text-align: center; margin-bottom: 15px; color: #333;">Detected Signs</h3>
          <div class="detection-boxes" style="display: flex; justify-content: center; gap: 40px; margin-bottom: 20px;">
            <div class="hand-box" style="text-align: center; padding: 15px; border-radius: 8px; min-width: 200px; background: #fff; border: 2px solid #ff0000;">
              <div style="font-size: 16px; color: #666;">Left Hand</div>
              <div id="left-hand-box" style="font-size: 36px; font-weight: bold; color: #ff0000; margin-top: 5px;">
                -
              </div>
            </div>
            <div class="hand-box" style="text-align: center; padding: 15px; border-radius: 8px; min-width: 200px; background: #fff; border: 2px solid #00ff00;">
              <div style="font-size: 16px; color: #666;">Right Hand</div>
              <div id="right-hand-box" style="font-size: 36px; font-weight: bold; color: #00ff00; margin-top: 5px;">
                -
              </div>
            </div>
          </div>
          
          <div id="sentence-box" style="background: #fff; padding: 20px; border-radius: 8px; margin-top: 20px;">
            <div id="current-sentence" style="font-size: 24px; font-weight: bold; color: #333; margin-bottom: 15px; text-align: center;">Current Sentence: </div>
            <div class="sentence-controls" style="display: flex; justify-content: center; gap: 10px;">
              <button onclick="updateSentence('add_space')" style="padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">Add Space</button>
              <button onclick="updateSentence('backspace')" style="padding: 8px 16px; background: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer;">Backspace</button>
              <button onclick="updateSentence('clear')" style="padding: 8px 16px; background: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer;">Clear</button>
            </div>
          </div>
        </div>

        <script>
        let lastLeftHand = '';
        let lastRightHand = '';

        async function fetchDetections() {
          try {
            const response = await fetch('/get_letters');
            const data = await response.json();
            
            // Update hand detection displays
            document.getElementById('left-hand-box').textContent = data.left_hand === 'No detection' ? '-' : data.left_hand;
            document.getElementById('right-hand-box').textContent = data.right_hand === 'No detection' ? '-' : data.right_hand;
            
            // Update sentence display
            document.getElementById('current-sentence').textContent = `Current Sentence: ${data.current_sentence}`;
            
            // Check for new letters to add
            if (data.left_hand !== lastLeftHand && data.left_hand !== 'No detection') {
              await updateSentence('add_letter', data.left_hand);
              lastLeftHand = data.left_hand;
            }
            if (data.right_hand !== lastRightHand && data.right_hand !== 'No detection') {
              await updateSentence('add_letter', data.right_hand);
              lastRightHand = data.right_hand;
            }
          } catch (err) {
            console.error('Error fetching detections:', err);
          }
        }

        async function updateSentence(action, letter = '') {
          try {
            const response = await fetch('/update_sentence', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({ action, letter }),
            });
            const data = await response.json();
            if (data.success) {
              document.getElementById('current-sentence').textContent = `Current Sentence: ${data.sentence}`;
            }
          } catch (err) {
            console.error('Error updating sentence:', err);
          }
        }

        setInterval(fetchDetections, 1000); // Poll every second
        fetchDetections(); // Initial load
        </script>
        <span>Try to make signs with both hands to form sentences.</span>
      </div>

      <hr />
      <div class="info"></div>
      <hr />
    </main>

    <script src="{{ url_for('static', filename='model.js') }}"></script>

  </body>
  </html>
